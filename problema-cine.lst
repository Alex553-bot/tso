BACI System: C-- to PCODE Compiler in C, 11:30   1 Oct 2012
Source file: problema-cine.cm  Sun Mar 26 18:43:38 2023
 line  pc
   1    0  typedef semaphore sem;
   2    0  sem filaE = 0, filaP = 0, contAE = 1, contAP = 1, servEn = 0, servPi = 0; 
   3    0  sem pEn = 0, pPi = 0;
   4    0  int contador; 
   5    0  void cliente(int ID) {
   6    0  	p(filaE); 
   7    2  	cout<<"Llega cliente "<<ID<<" pide atencion" <<endl; 
   8    7  	v(servEn); 
   9    9  	p(pEn); 
  10   11  	cout<<"Cliente "<<ID<<" obtiene entrada" <<endl;
  11   16  	v(filaE);
  12   18  	p(filaP); 
  13   20  	cout<<"Cliente "<<ID<<" solicita pipocas" <<endl;
  14   25  	v(servPi); 
  15   27  	p(pPi); 
  16   29  	cout<<"Cliente "<<ID<<" obtiene sus pipocas y se va a su sala"<<endl;
  17   34  	v(filaP);
  18   36  }
  19   37  void dEntradas(int ID) {
  20   37  	int j;
  21   37  	v(filaE);
  22   39  	while (1) {
  23   41  		p(contAE);
  24   43  			if(contador<=0) {j = 1;}
  25   50  			contador--;
  26   55  		v(contAE);  
  27   57  		if (j==0) {
  28   61  			p(servEn); 
  29   63  			cout<<"Dispensador de entradas "<<ID<<" entrega una entrada."<<endl;
  30   68  			v(pEn);
  31   70  		} else return;
  32   72  	}
  33   73  }
  34   74  void dPipocas(int ID) {
  35   74  	int j; 
  36   74  	v(filaP);
  37   76  	while (j<3) {
  38   80  		p(servPi); 
  39   82  		cout<<"Dispensador de pipocas "<<ID<<" prepara pipocas"<<endl;
  40   87  		v(pPi); 
  41   89  		j++;
  42   94  	}
  43   95  }
  44   96  void main() {
  45   97  	contador = 9;
  46  100  	cobegin {
  47  101  		cliente(1); cliente(5); cliente(4); 
  48  113  		cliente(2); cliente(3); cliente(6);
  49  125  		cliente(0); cliente(8); cliente(9);
  50  137  		dEntradas(1); dEntradas(2); dEntradas(3);
  51  149  		dPipocas(1); dPipocas(2); dPipocas(3);
  52  161  	}
  53  162  }
